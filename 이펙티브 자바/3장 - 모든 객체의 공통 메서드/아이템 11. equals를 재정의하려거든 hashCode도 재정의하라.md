# 아이템 11. equals를 재정의하려거든 hashCode도 재정의하라

equals를 재정의한 클래스 모두에서 hashCode도 재정의해야 한다. 그렇지 않으면 해시 기반의 컬렉션에 그 클래스의 인스턴스를 넣을 수 없다.

## Object 명세의 hashCode 규약

- equals 비교에 사용되는 정보가 변경되지 않았다면, 애플리케이션이 실행되는 동안 그 객체의 hashCode 메소드는 몇 번을 호출해도 일관되게 항상 같은 값을 반환해야 한다.
- equals(Object)가 두 객체를 같다고 판단했다면, 두 객체의 hashCode는 똑같은 값을 반환해야 한다.
- equals(Object)가 두 객체를 다르다고 판단했다고 해서, 두 객체의 hashCode가 반드시 다른 값을 반환할 필요는 없다. 하지만, 다른 값을 반환해야 해시 테이블의 성능이 좋아진다.

## hashCode 메소드를 재정의하지 않았을 때의 문제점

HashMap은 해시코드가 다른 엔트리끼리는 동치성 비교를 시도조차 하지 않도록 최적화되어 있다.

## 좋은 hashCode 메소드를 구현하는 방법

- @EqualsAndHashCode 어노테이션을 사용하기
- `Object.hash` 사용하기. 한 줄로 작성할 수 있지만 성능이 느리다.
- 클래스가 불변이고 해시코드를 계산하는 비용이 크다면, 계산된 해시코드를 캐싱해두는 방법도 있다.
- hashCode가 반환하는 값의 생성 규칙을 API 사용자에게 자세히 공표하지 않기
